app.controller('HeaderCtrl', ['$scope', '$auth', '$rootScope', 'UserService', '$localStorage', '$window', '$document', function($scope, $auth, $rootScope, UserService, $localStorage, $window, $document){

$scope.transparentNav = true
$document.on('scroll', function() {
  // do your things like logging the Y-axis

  if ($window.scrollY > (window.innerHeight)*.82){
    console.log($window.scrollY)
    $scope.transparentNav = false
    console.log("larger than 380 " +$scope.transparentNav)

  }else {
    $scope.transparentNav = true;
    console.log($window.scrollY)
    console.log("smaller than 380 "+$scope.transparentNav)

  }
  $scope.$apply();
});

  $scope.user = UserService.user;
  // console.log(($scope.user).loggedin)
  $scope.initCheckoutList = function () {
    $scope.checkoutList = [];
    $scope.checkoutList = $localStorage.checkoutList
    if (!$scope.checkoutList){
      $scope.checkoutList=[]
    }else {
      $scope.expirationTime = localStorage.expirationTime;
      // console.log($scope.expirationTime);
      $scope.currentTime = new Date();
      $scope.currentHour = $scope.currentTime.getTime();
      console.log($scope.expirationTime - $scope.currentHour)
      console.log($scope.checkoutList);
      if ($scope.expirationTime < $scope.currentHour){
        $localStorage.$reset();
        $scope.checkoutList = [];
      };
    }
  };

  $scope.saveCheckoutList = function () {
    $localStorage.checkoutList = $scope.checkoutList;

    $scope.currentTime = new Date();
    $scope.currentHour = $scope.currentTime.getTime();
    $scope.expirationTime = $scope.currentHour + (3*60*60*1000);
    localStorage.expirationTime = $scope.expirationTime;
  }

  $scope.checkoutTotal = function () {
    var total = 0;
    for (var i = 0; i < $scope.checkoutList.length; i++){
      total += $scope.checkoutList[i].price
    }
    return total;
  }


  $scope.deleteItem = function($index){
    $scope.deletedItem = $scope.checkoutList.splice($index, 1);
    console.log("item that was deleted")
    console.log($scope.deletedItem)
    console.log("items left in checkoutList")
    console.log($scope.checkoutList)
  }

  $scope.initCheckoutList();


  $scope.logout = function () {
    $auth.signOut().then(function(resp) {
      console.log(resp);
    }).catch(function(resp) {
      console.log(resp);
    });
  };

}])