app.controller('OrderDashboardCtrl', ['$scope', '$http', '$auth', 'UserService', 'URL_CONSTANTS', function($scope, $http, $auth, UserService, URL_CONSTANTS){

  $scope.getTodaysOrders = function() {

    $http.get(URL_CONSTANTS.domain + "/api/orders").then(function(resp){
      console.log(resp.data)
      $scope.orderDashboardData = resp.data
    }, function errorCallback(resp){
      console.log(resp)
    })

  };
  $scope.getTodaysOrders();

  $scope.startPreparing = function (id) {
    var preparingData = {
      preparing: true,
      ready: false,
      picked_up: false
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;


        }, function (resp){
          console.log(resp)
        });
  }

  $scope.foodIsReady = function (id) {
    var preparingData = {
      preparing: false,
      ready: true,
      picked_up: false
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;


        }, function (resp){
          console.log(resp)
        });
  }

  $scope.oppsNotPreparing = function (id) {
    var preparingData = {
      preparing: false,
      ready: false,
      picked_up: false
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;


        }, function (resp){
          console.log(resp)
        });
  }

  $scope.oppsFoodNotReady = function (id) {
    var preparingData = {
      preparing: true,
      ready: false,
      picked_up: false
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;


        }, function (resp){
          console.log(resp)
        });
  }

  $scope.oppsFoodNotPickedUp = function (id) {
    var preparingData = {
      preparing: false,
      ready: true,
      picked_up: false
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;


        }, function (resp){
          console.log(resp)
        });
  }

  $scope.foodPickedUp = function (id) {
    var preparingData = {
      preparing: false,
      ready: false,
      picked_up: true
    }
    $http.put(URL_CONSTANTS.domain + "/api/orders/"+id, preparingData).then(function (resp){
          // console.log(resp);
          console.log(resp.data);
          $scope.getTodaysOrders();
          $scope.results = false;

        }, function (resp){
          console.log(resp)
        });
  }

  $scope.orderPickupTabs = true

  $scope.clickOrders = function () {

    $scope.orderPickupTabs = true

  };

  $scope.clickPickups = function () {

    $scope.orderPickupTabs = false

  }

$scope.results = false

$scope.search = function () {

// console.log($scope.searchId)

$http.get(URL_CONSTANTS.domain + "/api/orders/"+$scope.searchId).then(function (resp){
          $scope.results = true;
          // console.log(resp);
          if (resp.data===null) {
            console.log("not found");
            console.log(resp);
            $scope.searchFound = false;
          }else {
          console.log("found")
          console.log(resp);
          console.log(resp.data);
          $scope.searchResultData = resp.data
          $scope.searchFound = true;

          }
          $scope.getSearchResults = resp.data;

        }, function (resp){
          console.log(resp);
          $scope.searchFound = false;

        });
          $scope.searchInputedId =$scope.searchId
          $scope.searchId=""

}


}]);